# ============================================================================
# ZENZSPA - CONFIGURACIÓN DE VARIABLES DE ENTORNO
# ============================================================================
# Este archivo contiene todas las variables de entorno necesarias para
# ejecutar ZenzSpa en desarrollo y producción.
#
# INSTRUCCIONES:
# 1. Copia este archivo a `.env` en la raíz del proyecto
# 2. Completa los valores según tu entorno
# 3. NUNCA commitees el archivo `.env` al repositorio
# ============================================================================

# ----------------------------------------------------------------------------
# DJANGO CORE
# ----------------------------------------------------------------------------
# Modo debug (1=desarrollo, 0=producción)
DEBUG=1

# Clave secreta de Django (generar con: python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())")
SECRET_KEY=your-secret-key-here-change-in-production

# Claves secretas de respaldo (opcional, separadas por espacios)
SECRET_KEY_FALLBACKS=

# Clave de encriptación Fernet para datos sensibles (generar con: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())")
FERNET_KEY=your-fernet-key-here

# ----------------------------------------------------------------------------
# HOSTS Y DOMINIOS
# ----------------------------------------------------------------------------
# Hosts permitidos (separados por espacios o comas)
# PRODUCCIÓN: Usar dominios reales, SIN localhost
ALLOWED_HOSTS=localhost 127.0.0.1

# Orígenes CORS permitidos (separados por espacios)
# PRODUCCIÓN: Usar dominios reales con HTTPS, SIN localhost
CORS_ALLOWED_ORIGINS=http://localhost:3000 http://127.0.0.1:3000

# Orígenes CSRF confiables (separados por espacios)
# PRODUCCIÓN: Usar dominios reales con HTTPS, SIN localhost
CSRF_TRUSTED_ORIGINS=http://localhost:3000 http://127.0.0.1:3000

# Permitir credenciales en CORS (1=sí, 0=no)
CORS_ALLOW_CREDENTIALS=1

# URL del sitio (para emails y notificaciones)
# PRODUCCIÓN: Debe usar https://
SITE_URL=http://localhost:8000

# Email por defecto para notificaciones
# PRODUCCIÓN: Debe estar configurado
DEFAULT_FROM_EMAIL=ZenzSpa <no-reply@zenzspa.com>

# ----------------------------------------------------------------------------
# BASE DE DATOS
# ----------------------------------------------------------------------------
DB_NAME=zenzspa
DB_USER=postgres
DB_PASSWORD=your-db-password-here
DB_HOST=127.0.0.1
DB_PORT=5432
DB_CONN_MAX_AGE=60
# PRODUCCIÓN: Usar 'require' para SSL
DB_SSLMODE=prefer

# ----------------------------------------------------------------------------
# REDIS Y CACHÉ
# ----------------------------------------------------------------------------
# URL de Redis (PRODUCCIÓN: debe usar rediss:// con TLS)
REDIS_URL=redis://127.0.0.1:6379/1
CACHE_TIMEOUT=300

# ----------------------------------------------------------------------------
# CELERY
# ----------------------------------------------------------------------------
# URL del broker de Celery (PRODUCCIÓN: debe usar rediss:// con TLS)
CELERY_BROKER_URL=redis://127.0.0.1:6379/0
CELERY_RESULT_BACKEND=redis://127.0.0.1:6379/0

# Archivo de schedule de Celery Beat
# PRODUCCIÓN: Usar /var/run/zenzspa/celerybeat-schedule
CELERY_BEAT_SCHEDULE_FILENAME=

# Configuración de tareas
CELERY_TASK_TIME_LIMIT=120
CELERY_TASK_SOFT_TIME_LIMIT=100
CELERY_WORKER_MAX_TASKS_PER_CHILD=500

# ----------------------------------------------------------------------------
# TWILIO (SMS/OTP/WhatsApp)
# ----------------------------------------------------------------------------
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_VERIFY_SERVICE_SID=your-twilio-verify-service-sid
TWILIO_PHONE_NUMBER=+14155551234  # Número para SMS/llamadas
TWILIO_WHATSAPP_FROM=+14155238886  # Número WhatsApp Business (sandbox: +14155238886)

# ----------------------------------------------------------------------------
# WOMPI (PAGOS)
# ----------------------------------------------------------------------------
WOMPI_BASE_URL=https://sandbox.wompi.co/v1
WOMPI_PUBLIC_KEY=pub_test_2Vkt6r1tIzdcOPnnv3w1gwdSN8FAJ759
WOMPI_PRIVATE_KEY=prv_test_tw0GsSicZrs32qkCgtApuTXfikozRXfp
WOMPI_INTEGRITY_SECRET=test_integrity_bhFKktEKLRGuiii3wUQH89pzrXGLvtDl
WOMPI_INTEGRITY_KEY=test_integrity_bhFKktEKLRGuiii3wUQH89pzrXGLvtDl
WOMPI_EVENT_SECRET=test_events_E1xGV2n5EzZJw67XtrQeK5bPMSVIgFS5
WOMPI_ACCEPTANCE_TOKEN=
# PRODUCCIÓN: Debe usar https://
WOMPI_REDIRECT_URL=http://localhost:3000/payment-result
WOMPI_PAYOUT_PRIVATE_KEY=
WOMPI_PAYOUT_BASE_URL=
WOMPI_DEVELOPER_DESTINATION=

# ----------------------------------------------------------------------------
# GEMINI AI (BOT)
# ----------------------------------------------------------------------------
GEMINI_API_KEY=your-gemini-api-key
GEMINI_MODEL=gemini-2.5-flash-lite
BOT_GEMINI_TIMEOUT=20

# ----------------------------------------------------------------------------
# RECAPTCHA
# ----------------------------------------------------------------------------
RECAPTCHA_V3_SITE_KEY=your-recaptcha-site-key
RECAPTCHA_V3_SECRET_KEY=your-recaptcha-secret-key
RECAPTCHA_V3_DEFAULT_SCORE=0.5
# Scores por acción (formato: action1:score1,action2:score2)
RECAPTCHA_V3_ACTION_SCORES=otp:0.7,verify:0.3

# ----------------------------------------------------------------------------
# EMAIL
# ----------------------------------------------------------------------------
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.sendgrid.net
EMAIL_PORT=587
EMAIL_USE_TLS=1
EMAIL_HOST_USER=your-email-user
EMAIL_HOST_PASSWORD=your-email-password

# ----------------------------------------------------------------------------
# KIOSKO
# ----------------------------------------------------------------------------
KIOSK_SESSION_TIMEOUT_MINUTES=10
KIOSK_SECURE_SCREEN_URL=/kiosk/secure
KIOSK_ALLOWED_PATH_PREFIXES=/api/v1/kiosk/ /api/v1/users/ /api/v1/dosha-quiz/
KIOSK_ALLOWED_VIEW_NAMES=clinical-profile-me clinical-profile-list clinical-profile-detail clinical-profile-update

# ----------------------------------------------------------------------------
# SEGURIDAD
# ----------------------------------------------------------------------------
# HSTS (HTTP Strict Transport Security) en segundos
HSTS_SECONDS=31536000

# Confiar en headers del proxy (1=sí, 0=no)
# Solo activar si usas NGINX, ALB, Cloudflare, etc.
TRUST_PROXY=0

# Rutas exentas de redirección SSL (separadas por espacios)
SECURE_REDIRECT_EXEMPT=

# Configuración de cookies
SESSION_COOKIE_SAMESITE=Lax

# ----------------------------------------------------------------------------
# CONTENT SECURITY POLICY (CSP)
# ----------------------------------------------------------------------------
# URL para reportes de violaciones CSP (opcional)
CSP_REPORT_URI=

# ----------------------------------------------------------------------------
# RATE LIMITING (THROTTLING)
# ----------------------------------------------------------------------------
# Límites generales
THROTTLE_USER=100/min
THROTTLE_ANON=30/min

# Límites específicos
THROTTLE_AUTH_LOGIN=3/min
THROTTLE_AUTH_VERIFY=3/10min
THROTTLE_PAYMENTS=30/min
THROTTLE_ADMIN=1000/hour

# Bot
THROTTLE_BOT=5/min
THROTTLE_BOT_DAILY=100/day
THROTTLE_BOT_IP=20/hour

# Endpoints críticos
THROTTLE_APPT_CREATE=10/hour
THROTTLE_PROFILE_UPDATE=20/hour
THROTTLE_ANALYTICS_EXPORT=5/hour

# ----------------------------------------------------------------------------
# DJANGO AXES (PROTECCIÓN CONTRA FUERZA BRUTA)
# ----------------------------------------------------------------------------
# Activar django-axes (1=sí, 0=no)
AXES_ENABLED=0

# Número de intentos fallidos antes de bloquear
AXES_FAILURE_LIMIT=5

# Tiempo de bloqueo en minutos
AXES_COOLOFF_TIME_MIN=10

# ----------------------------------------------------------------------------
# LOGGING
# ----------------------------------------------------------------------------
# Nivel de log (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO
DB_LOG_LEVEL=WARNING

# Umbral de request lenta en segundos
SLOW_REQUEST_THRESHOLD=1.0

# ----------------------------------------------------------------------------
# SENTRY (MONITOREO DE ERRORES)
# ----------------------------------------------------------------------------
SENTRY_DSN=
SENTRY_ENV=development
SENTRY_TRACES_SAMPLE_RATE=0.1
# Commit de Git para tracking de releases
GIT_COMMIT=local

# ----------------------------------------------------------------------------
# NEW RELIC (APM)
# ----------------------------------------------------------------------------
NEW_RELIC_LICENSE_KEY=
NEW_RELIC_CONFIG_FILE=
NEW_RELIC_ENV=production

# ----------------------------------------------------------------------------
# DEBUG TOOLBAR (SOLO DESARROLLO)
# ----------------------------------------------------------------------------
# IPs permitidas para debug toolbar (separadas por espacios)
DEBUG_TOOLBAR_IPS=127.0.0.1 ::1

# ----------------------------------------------------------------------------
# API
# ----------------------------------------------------------------------------
# Tamaño de página para paginación
API_PAGE_SIZE=20

# ----------------------------------------------------------------------------
# JWT
# ----------------------------------------------------------------------------
# Duración del access token en minutos
JWT_ACCESS_MIN=15

# Duración del refresh token en días
JWT_REFRESH_DAYS=7

# Algoritmo de firma (HS256, RS256, etc.)
JWT_ALG=HS256

# Clave de firma (opcional, usa SECRET_KEY por defecto)
JWT_SIGNING_KEY=

# ----------------------------------------------------------------------------
# PASSWORDS
# ----------------------------------------------------------------------------
# Longitud mínima de contraseña
PASSWORD_MIN_LENGTH=8

# ============================================================================
# NOTAS DE PRODUCCIÓN
# ============================================================================
# 
# CRÍTICO - Antes de desplegar a producción:
# 
# 1. DEBUG=0
# 2. SECRET_KEY único y seguro (no usar el de ejemplo)
# 3. ALLOWED_HOSTS con dominios reales (sin localhost)
# 4. CORS_ALLOWED_ORIGINS con dominios reales HTTPS (sin localhost)
# 5. REDIS_URL con rediss:// (TLS)
# 6. CELERY_BROKER_URL con rediss:// (TLS)
# 7. SITE_URL con https://
# 8. WOMPI_REDIRECT_URL con https://
# 9. DB_SSLMODE=require
# 10. Configurar SENTRY_DSN para monitoreo
# 
# Validar configuración antes de deploy:
#   python -m scripts.validate_settings
# 
# ============================================================================
