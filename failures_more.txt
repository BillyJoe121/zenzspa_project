============================= test session starts =============================
platform win32 -- Python 3.13.3, pytest-9.0.1, pluggy-1.6.0 -- C:\Users\joshe\Desktop\Zenz\studiozens\venv\Scripts\python.exe
cachedir: .pytest_cache
django: version: 5.2.3, settings: studiozens.settings (from ini)
rootdir: C:\Users\joshe\Desktop\Zenz\studiozens
configfile: pytest.ini
plugins: anyio-4.11.0, cov-7.0.0, django-4.11.1, mock-3.15.1
collecting ... collected 22 items

finances/tests/test_more.py::PaymentServiceEdgeTests::test_apply_gateway_status_declined PASSED [  4%]
finances/tests/test_more.py::PaymentServiceEdgeTests::test_apply_gateway_status_sets_transaction_id_on_approved FAILED [  9%]
finances/tests/test_more.py::PaymentServiceEdgeTests::test_charge_recurrence_token_amount_zero_raises PASSED [ 13%]
finances/tests/test_more.py::PaymentServiceEdgeTests::test_charge_recurrence_token_missing_email_declines PASSED [ 18%]
finances/tests/test_more.py::PaymentServiceEdgeTests::test_charge_recurrence_token_missing_token_raises PASSED [ 22%]
finances/tests/test_more.py::PaymentServiceEdgeTests::test_charge_recurrence_token_missing_user_raises PASSED [ 27%]
finances/tests/test_more.py::GatewayEdgeTests::test_build_integrity_signature_without_key_returns_none PASSED [ 31%]
finances/tests/test_more.py::GatewayEdgeTests::test_fetch_transaction_missing_base_or_reference_returns_none PASSED [ 36%]
finances/tests/test_more.py::GatewayEdgeTests::test_resolve_acceptance_token_missing_config_returns_none PASSED [ 40%]
finances/tests/test_more.py::WebhookViewTests::test_webhook_view_handles_transaction_updated FAILED [ 45%]
finances/tests/test_more.py::WebhookViewTests::test_webhook_view_returns_400_on_value_error PASSED [ 50%]
finances/tests/test_more.py::DisbursementClientTests::test_create_payout_missing_destination_raises FAILED [ 54%]
finances/tests/test_more.py::DisbursementClientTests::test_get_available_balance_invalid_json_raises FAILED [ 59%]
finances/tests/test_more.py::DisbursementClientTests::test_request_with_retry_retries_timeout FAILED [ 63%]
finances/tests/test_more.py::DeveloperCommissionTests::test_evaluate_payout_below_threshold FAILED [ 68%]
finances/tests/test_more.py::DeveloperCommissionTests::test_register_commission_returns_none_without_amount FAILED [ 72%]
finances/tests/test_more.py::SubscriptionTasksTests::test_downgrade_expired_vips_changes_role FAILED [ 77%]
finances/tests/test_more.py::SubscriptionTasksTests::test_process_recurring_subscriptions_price_not_configured PASSED [ 81%]
finances/tests/test_more.py::SubscriptionTasksTests::test_run_developer_payout_task PASSED [ 86%]
finances/tests/test_more.py::InitiateViewsTests::test_initiate_appointment_payment_requires_pending_payment PASSED [ 90%]
finances/tests/test_more.py::InitiateViewsTests::test_initiate_package_purchase_invalid_payload PASSED [ 95%]
finances/tests/test_more.py::InitiateViewsTests::test_initiate_vip_subscription_view_missing_price_returns_500 PASSED [100%]

================================== FAILURES ===================================
_ PaymentServiceEdgeTests.test_apply_gateway_status_sets_transaction_id_on_approved _
finances\services.py:275: in _attempt_payout
    balance = client.get_available_balance()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
finances\services.py:136: in get_available_balance
    raise WompiPayoutError("Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.")
E   finances.services.WompiPayoutError: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.

During handling of the above exception, another exception occurred:
finances\tests\test_more.py:37: in test_apply_gateway_status_sets_transaction_id_on_approved
    PaymentService.apply_gateway_status(self.payment, "APPROVED", payload)
finances\payments.py:96: in apply_gateway_status
    DeveloperCommissionService.handle_successful_payment(payment)
finances\services.py:255: in handle_successful_payment
    return cls.evaluate_payout()
           ^^^^^^^^^^^^^^^^^^^^^
finances\services.py:269: in evaluate_payout
    return cls._attempt_payout(settings_obj, debt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
finances\services.py:278: in _attempt_payout
    cls._enter_default(settings_obj, current_debt=current_debt)
finances\services.py:388: in _enter_default
    settings_obj.save(update_fields=["developer_in_default", "developer_default_since", "updated_at"])
core\models\settings.py:261: in save
    super().save(*args, **kwargs)
venv\Lib\site-packages\django\db\models\base.py:902: in save
    self.save_base(
venv\Lib\site-packages\django\db\models\base.py:1008: in save_base
    updated = self._save_table(
venv\Lib\site-packages\django\db\models\base.py:1144: in _save_table
    raise DatabaseError("Save with update_fields did not affect any rows.")
E   django.db.utils.DatabaseError: Save with update_fields did not affect any rows.
---------------------------- Captured stderr call -----------------------------
[ERROR] No se pudo consultar saldo Wompi: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.
------------------------------ Captured log call ------------------------------
ERROR    finances.services:services.py:277 No se pudo consultar saldo Wompi: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.
_______ WebhookViewTests.test_webhook_view_handles_transaction_updated ________
finances\services.py:275: in _attempt_payout
    balance = client.get_available_balance()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
finances\services.py:136: in get_available_balance
    raise WompiPayoutError("Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.")
E   finances.services.WompiPayoutError: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.

During handling of the above exception, another exception occurred:
finances\tests\test_more.py:121: in test_webhook_view_handles_transaction_updated
    result = service.process_transaction_update()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\AppData\Local\Programs\Python\Python313\Lib\contextlib.py:85: in inner
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
finances\webhooks.py:330: in process_transaction_update
    PaymentService.apply_gateway_status(
finances\payments.py:96: in apply_gateway_status
    DeveloperCommissionService.handle_successful_payment(payment)
finances\services.py:255: in handle_successful_payment
    return cls.evaluate_payout()
           ^^^^^^^^^^^^^^^^^^^^^
finances\services.py:269: in evaluate_payout
    return cls._attempt_payout(settings_obj, debt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
finances\services.py:278: in _attempt_payout
    cls._enter_default(settings_obj, current_debt=current_debt)
finances\services.py:388: in _enter_default
    settings_obj.save(update_fields=["developer_in_default", "developer_default_since", "updated_at"])
core\models\settings.py:261: in save
    super().save(*args, **kwargs)
venv\Lib\site-packages\django\db\models\base.py:902: in save
    self.save_base(
venv\Lib\site-packages\django\db\models\base.py:1008: in save_base
    updated = self._save_table(
venv\Lib\site-packages\django\db\models\base.py:1144: in _save_table
    raise DatabaseError("Save with update_fields did not affect any rows.")
E   django.db.utils.DatabaseError: Save with update_fields did not affect any rows.
---------------------------- Captured stderr call -----------------------------
[DEBUG] 
def notify_order_status_change(order_id, new_status):
    return 1

[DEBUG] 
def release_expired_order_reservations():
    return 1

[DEBUG] 
def cleanup_expired_carts():
    return 1

[INFO] [PAYMENT-SUCCESS] Webhook validado correctamente (event=transaction.updated)
[ERROR] No se pudo consultar saldo Wompi: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.
[ERROR] [PAYMENT-ALERT] Webhook Error: Save with update_fields did not affect any rows.
Traceback (most recent call last):
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 275, in _attempt_payout
    balance = client.get_available_balance()
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 136, in get_available_balance
    raise WompiPayoutError("Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.")
finances.services.WompiPayoutError: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\webhooks.py", line 330, in process_transaction_update
    PaymentService.apply_gateway_status(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        payment, transaction_status, transaction_data)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\payments.py", line 96, in apply_gateway_status
    DeveloperCommissionService.handle_successful_payment(payment)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 255, in handle_successful_payment
    return cls.evaluate_payout()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 269, in evaluate_payout
    return cls._attempt_payout(settings_obj, debt)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 278, in _attempt_payout
    cls._enter_default(settings_obj, current_debt=current_debt)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 388, in _enter_default
    settings_obj.save(update_fields=["developer_in_default", "developer_default_since", "updated_at"])
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\core\models\settings.py", line 261, in save
    super().save(*args, **kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\venv\Lib\site-packages\django\db\models\base.py", line 902, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\venv\Lib\site-packages\django\db\models\base.py", line 1008, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\joshe\Desktop\Zenz\studiozens\venv\Lib\site-packages\django\db\models\base.py", line 1144, in _save_table
    raise DatabaseError("Save with update_fields did not affect any rows.")
django.db.utils.DatabaseError: Save with update_fields did not affect any rows.
------------------------------ Captured log call ------------------------------
DEBUG    celery.utils.functional:functional.py:335 
def notify_order_status_change(order_id, new_status):
    return 1

DEBUG    celery.utils.functional:functional.py:335 
def release_expired_order_reservations():
    return 1

DEBUG    celery.utils.functional:functional.py:335 
def cleanup_expired_carts():
    return 1

INFO     finances.webhooks:webhooks.py:157 [PAYMENT-SUCCESS] Webhook validado correctamente (event=transaction.updated)
ERROR    finances.services:services.py:277 No se pudo consultar saldo Wompi: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.
ERROR    finances.webhooks:webhooks.py:340 [PAYMENT-ALERT] Webhook Error: Save with update_fields did not affect any rows.
Traceback (most recent call last):
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 275, in _attempt_payout
    balance = client.get_available_balance()
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 136, in get_available_balance
    raise WompiPayoutError("Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.")
finances.services.WompiPayoutError: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\webhooks.py", line 330, in process_transaction_update
    PaymentService.apply_gateway_status(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        payment, transaction_status, transaction_data)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\payments.py", line 96, in apply_gateway_status
    DeveloperCommissionService.handle_successful_payment(payment)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 255, in handle_successful_payment
    return cls.evaluate_payout()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 269, in evaluate_payout
    return cls._attempt_payout(settings_obj, debt)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 278, in _attempt_payout
    cls._enter_default(settings_obj, current_debt=current_debt)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\finances\services.py", line 388, in _enter_default
    settings_obj.save(update_fields=["developer_in_default", "developer_default_since", "updated_at"])
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\core\models\settings.py", line 261, in save
    super().save(*args, **kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\venv\Lib\site-packages\django\db\models\base.py", line 902, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\joshe\Desktop\Zenz\studiozens\venv\Lib\site-packages\django\db\models\base.py", line 1008, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\joshe\Desktop\Zenz\studiozens\venv\Lib\site-packages\django\db\models\base.py", line 1144, in _save_table
    raise DatabaseError("Save with update_fields did not affect any rows.")
django.db.utils.DatabaseError: Save with update_fields did not affect any rows.
____ DisbursementClientTests.test_create_payout_missing_destination_raises ____
finances\tests\test_more.py:144: in test_create_payout_missing_destination_raises
    client.create_payout(1000, destination_id=None)
E   TypeError: WompiDisbursementClient.create_payout() got an unexpected keyword argument 'destination_id'
___ DisbursementClientTests.test_get_available_balance_invalid_json_raises ____
finances\tests\test_more.py:139: in test_get_available_balance_invalid_json_raises
    client.get_available_balance()
finances\services.py:136: in get_available_balance
    raise WompiPayoutError("Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.")
E   finances.services.WompiPayoutError: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.
_______ DisbursementClientTests.test_request_with_retry_retries_timeout _______
finances\tests\test_more.py:149: in test_request_with_retry_retries_timeout
    mock_post.side_effect = [requests.Timeout, mock.Mock(status_code=200)]
                             ^^^^^^^^
E   NameError: name 'requests' is not defined
________ DeveloperCommissionTests.test_evaluate_payout_below_threshold ________
finances\tests\test_more.py:159: in test_evaluate_payout_below_threshold
    self.assertIsNone(result)
E   AssertionError: {'status': 'balance_unavailable', 'detail': 'Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.'} is not None
---------------------------- Captured stderr call -----------------------------
[ERROR] No se pudo consultar saldo Wompi: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.
------------------------------ Captured log call ------------------------------
ERROR    finances.services:services.py:277 No se pudo consultar saldo Wompi: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.
_ DeveloperCommissionTests.test_register_commission_returns_none_without_amount _
venv\Lib\site-packages\django\db\backends\utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   psycopg2.errors.NotNullViolation: null value in column "amount" of relation "finances_payment" violates not-null constraint
E   DETAIL:  Failing row contains (ee9c040b-5126-44fc-a878-0df57607dd8a, 2025-12-02 09:09:03.333399+00, 2025-12-02 09:09:03.333424+00, null, PENDING, ADVANCE, , {}, , , null, null, , {}, null, null, null, null).

The above exception was the direct cause of the following exception:
finances\tests\test_more.py:162: in test_register_commission_returns_none_without_amount
    payment = baker.make(Payment, amount=None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\model_bakery\baker.py:147: in make
    return baker.make(
venv\Lib\site-packages\model_bakery\baker.py:406: in make
    return self._make(**params)
           ^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\model_bakery\baker.py:482: in _make
    instance = self.instance(
venv\Lib\site-packages\model_bakery\baker.py:535: in instance
    instance.save(**_save_kwargs)
venv\Lib\site-packages\django\db\models\base.py:902: in save
    self.save_base(
venv\Lib\site-packages\django\db\models\base.py:1008: in save_base
    updated = self._save_table(
venv\Lib\site-packages\django\db\models\base.py:1169: in _save_table
    results = self._do_insert(
venv\Lib\site-packages\django\db\models\base.py:1210: in _do_insert
    return manager._insert(
venv\Lib\site-packages\django\db\models\manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\db\models\query.py:1868: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\db\models\sql\compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
venv\Lib\site-packages\django\db\backends\utils.py:79: in execute
    return self._execute_with_wrappers(
venv\Lib\site-packages\django\db\backends\utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\db\backends\utils.py:100: in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\db\utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
venv\Lib\site-packages\django\db\backends\utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   django.db.utils.IntegrityError: null value in column "amount" of relation "finances_payment" violates not-null constraint
E   DETAIL:  Failing row contains (ee9c040b-5126-44fc-a878-0df57607dd8a, 2025-12-02 09:09:03.333399+00, 2025-12-02 09:09:03.333424+00, null, PENDING, ADVANCE, , {}, , , null, null, , {}, null, null, null, null).
_______ SubscriptionTasksTests.test_downgrade_expired_vips_changes_role _______
finances\tests\test_more.py:172: in test_downgrade_expired_vips_changes_role
    user = baker.make("users.CustomUser", role="VIP", vip_status="ACTIVE", vip_expiration_date=timezone.now().date() - timedelta(days=1))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\model_bakery\baker.py:147: in make
    return baker.make(
venv\Lib\site-packages\model_bakery\baker.py:406: in make
    return self._make(**params)
           ^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\model_bakery\baker.py:482: in _make
    instance = self.instance(
venv\Lib\site-packages\model_bakery\baker.py:530: in instance
    instance = self.model(**attrs)
               ^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\db\models\base.py:569: in __init__
    raise TypeError(
E   TypeError: CustomUser() got unexpected keyword arguments: 'vip_status', 'vip_expiration_date'
=========================== short test summary info ===========================
FAILED finances/tests/test_more.py::PaymentServiceEdgeTests::test_apply_gateway_status_sets_transaction_id_on_approved - django.db.utils.DatabaseError: Save with update_fields did not affect any rows.
FAILED finances/tests/test_more.py::WebhookViewTests::test_webhook_view_handles_transaction_updated - django.db.utils.DatabaseError: Save with update_fields did not affect any rows.
FAILED finances/tests/test_more.py::DisbursementClientTests::test_create_payout_missing_destination_raises - TypeError: WompiDisbursementClient.create_payout() got an unexpected keyword argument 'destination_id'
FAILED finances/tests/test_more.py::DisbursementClientTests::test_get_available_balance_invalid_json_raises - finances.services.WompiPayoutError: Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.
FAILED finances/tests/test_more.py::DisbursementClientTests::test_request_with_retry_retries_timeout - NameError: name 'requests' is not defined
FAILED finances/tests/test_more.py::DeveloperCommissionTests::test_evaluate_payout_below_threshold - AssertionError: {'status': 'balance_unavailable', 'detail': 'Configura WOMPI_PAYOUT_BASE_URL para consultar el balance de Wompi.'} is not None
FAILED finances/tests/test_more.py::DeveloperCommissionTests::test_register_commission_returns_none_without_amount - django.db.utils.IntegrityError: null value in column "amount" of relation "finances_payment" violates not-null constraint
DETAIL:  Failing row contains (ee9c040b-5126-44fc-a878-0df57607dd8a, 2025-12-02 09:09:03.333399+00, 2025-12-02 09:09:03.333424+00, null, PENDING, ADVANCE, , {}, , , null, null, , {}, null, null, null, null).
FAILED finances/tests/test_more.py::SubscriptionTasksTests::test_downgrade_expired_vips_changes_role - TypeError: CustomUser() got unexpected keyword arguments: 'vip_status', 'vip_expiration_date'
======================== 8 failed, 14 passed in 3.09s =========================
