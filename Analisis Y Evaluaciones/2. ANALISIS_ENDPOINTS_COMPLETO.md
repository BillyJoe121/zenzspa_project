# AN√ÅLISIS COMPLETO DE CRUD ADMIN - StudioZens
**Fecha:** 2025-11-29
**An√°lisis:** Accesos administrativos, APIs disponibles y vulnerabilidades

---

## üìä RESUMEN EJECUTIVO

### Estado General
- **Total de Modelos Identificados:** 50+
- **APIs con CRUD Completo:** 8
- **APIs con CRUD Parcial:** 12
- **Modelos SIN API:** 15+
- **‚ö†Ô∏è CR√çTICO - Vulnerabilidades Detectadas:** 5

---

## üî¥ VULNERABILIDADES CR√çTICAS DETECTADAS

### 1. **ProductViewSet - Acceso P√∫blico SIN Autenticaci√≥n**
**Archivo:** `marketplace/views.py:35`
```python
permission_classes = [permissions.AllowAny]
```
**Problema:** Cualquier persona puede ver el cat√°logo completo de productos, incluyendo precios VIP, stock disponible y reserved_stock.

**Exposici√≥n de datos sensibles:**
- Stock real y reservado (informaci√≥n de negocio)
- Precios VIP (descuentos exclusivos)
- Variantes y SKUs (informaci√≥n de inventario)

**Recomendaci√≥n:** Cambiar a `IsAuthenticatedOrReadOnly` y ocultar campos sensibles para usuarios an√≥nimos.

---

### 2. **OrderViewSet - Filtrado D√©bil por Rol**
**Archivo:** `marketplace/views.py:323-336`
```python
def get_queryset(self):
    if getattr(user, 'role', None) in [CustomUser.Role.ADMIN, CustomUser.Role.STAFF]:
        return queryset  # ‚ö†Ô∏è Staff puede ver TODAS las √≥rdenes
    return queryset.filter(user=user)
```
**Problema:** El personal de STAFF puede acceder a TODAS las √≥rdenes de TODOS los clientes sin restricciones.

**Datos expuestos:**
- Direcciones de env√≠o completas
- Historial de compras de todos los usuarios
- M√©todos de pago utilizados
- Vouchers aplicados
- Razones de devoluci√≥n

**Recomendaci√≥n:** Limitar acceso de STAFF solo a √≥rdenes que necesiten atender, no a todas.

---

### 3. **ClinicalProfileViewSet - Staff con Acceso Total a Historial M√©dico**
**Archivo:** `profiles/views.py:38-60`
```python
if user.role in [CustomUser.Role.ADMIN, CustomUser.Role.STAFF]:
    return base_queryset  # ‚ö†Ô∏è Staff puede ver TODOS los perfiles m√©dicos
```
**Problema:** VIOLACI√ìN DE HIPAA/GDPR - Staff tiene acceso sin restricciones a:
- Condiciones m√©dicas (`medical_conditions`)
- Alergias (`allergies`)
- Contraindicaciones (`contraindications`)
- Notas de accidentes (`accidents_notes`)
- Historial de dolores (`pains`)
- Historial completo versionado (`history`)

**Recomendaci√≥n URGENTE:**
- Implementar control de acceso basado en "need-to-know"
- Auditar TODOS los accesos a perfiles cl√≠nicos
- Requerir justificaci√≥n para accesos de staff

---

### 4. **Analytics - Sin Rate Limiting Efectivo**
**Archivo:** `analytics/views.py`
**Problema:** Aunque existe `AnalyticsRateThrottle`, no hay validaci√≥n de rangos m√°ximos de consulta.

**Riesgo:**
- Consultas masivas pueden generar DoS
- Exportaci√≥n de datos sin l√≠mites
- Queries pesados sin paginaci√≥n

**Recomendaci√≥n:** Implementar l√≠mites estrictos de rango de fechas y paginaci√≥n obligatoria.

---

### 5. **Marketplace - Falta CRUD Admin para Gesti√≥n de Inventario**
**Problema:** NO existe API administrativa para:
- Crear/editar productos
- Gestionar variantes
- Ajustar inventario
- Moderar rese√±as de productos

**Situaci√≥n actual:**
- ‚úÖ Django Admin disponible
- ‚ùå NO hay API REST para admin frontend
- ‚ùå No hay control de stock automatizado

**Impacto:** Dependencia total del Django Admin, sin posibilidad de construir panel administrativo moderno.

---

## üìã AN√ÅLISIS DETALLADO POR M√ìDULO

### üõçÔ∏è MARKETPLACE

#### Modelos Principales
1. **Product** - Productos del cat√°logo
2. **ProductVariant** - Variantes (SKUs, precios, stock)
3. **ProductImage** - Im√°genes de productos
4. **Cart** - Carritos de compra
5. **CartItem** - Items del carrito
6. **Order** - √ìrdenes de compra
7. **OrderItem** - Items de √≥rdenes
8. **InventoryMovement** - Movimientos de inventario
9. **ProductReview** - Rese√±as de productos

#### APIs Disponibles para ADMIN

##### ‚úÖ ProductViewSet (SOLO LECTURA - P√∫blico)
**Endpoint:** `/api/v1/marketplace/products/`
**Permisos:** `AllowAny` ‚ö†Ô∏è
**Acciones disponibles:**
- `list()` - Listar productos
- `retrieve()` - Ver detalle
- `variants()` - Ver variantes
- `reviews()` - Ver rese√±as aprobadas

**‚ùå NO DISPONIBLE:**
- Crear productos
- Editar productos
- Eliminar productos
- Gestionar stock
- Cambiar precios

---

##### ‚úÖ ProductReviewViewSet (CRUD Completo)
**Endpoint:** `/api/v1/marketplace/reviews/`
**Permisos:** `IsAuthenticatedOrReadOnly`
**Acciones admin disponibles:**
- `respond()` - Responder a rese√±a (requiere `IsAdminUser`)
- Aprobar/rechazar rese√±as (`is_approved`)
- Ver todas las rese√±as (incluso no aprobadas)

**‚ùå FALTA:**
- Moderaci√≥n masiva
- Filtros por estado de aprobaci√≥n
- Estad√≠sticas de rese√±as

---

##### ‚úÖ OrderViewSet (LECTURA + Acciones Limitadas)
**Endpoint:** `/api/v1/marketplace/orders/`
**Permisos:** `IsAuthenticated`
**Acciones disponibles:**
- `list()` - Staff/Admin ven TODAS las √≥rdenes ‚ö†Ô∏è
- `retrieve()` - Ver detalle de orden
- `process_return()` - Procesar devoluciones (solo admin)

**‚ùå NO DISPONIBLE:**
- Crear √≥rdenes manualmente
- Editar √≥rdenes existentes
- Cambiar estados de env√≠o
- Agregar tracking numbers
- Gestionar fraud alerts

---

##### ‚ùå CartViewSet (SOLO PARA CLIENTES)
**Endpoint:** `/api/v1/marketplace/cart/`
**Permisos:** `IsAuthenticated`
**Notas:** No hay acceso admin para ver/gestionar carritos abandonados

---

#### ‚ùå MODELOS SIN API ADMIN

1. **Product** - Solo Django Admin
2. **ProductVariant** - Solo Django Admin
3. **ProductImage** - Solo Django Admin
4. **InventoryMovement** - Solo Django Admin (sin CRUD, solo lectura)

---

### üìÖ SPA (Appointments)

#### Modelos Principales
1. **Service** - Servicios del spa
2. **ServiceCategory** - Categor√≠as de servicios
3. **Appointment** - Citas
4. **AppointmentItem** - Items de citas
5. **StaffAvailability** - Disponibilidad de staff
6. **AvailabilityExclusion** - Bloqueos de horarios
7. **Package** - Paquetes de servicios
8. **PackageService** - Servicios incluidos en paquetes
9. **UserPackage** - Paquetes comprados por usuarios
10. **Voucher** - Vouchers de servicios
11. **WaitlistEntry** - Lista de espera
12. **LoyaltyRewardLog** - Log de recompensas

#### APIs Disponibles para ADMIN

##### ‚úÖ AppointmentViewSet (CRUD Completo)
**Endpoint:** `/api/v1/appointments/`
**Permisos:** `IsAuthenticated, IsVerified`
**Acciones disponibles:**
- `list()` - Admin/Staff ven TODAS las citas
- `create()` - Crear citas
- `retrieve()` - Ver detalle
- `reschedule()` - Reagendar
- `add_tip()` - Agregar propina
- `suggestions()` - Sugerencias de horarios

**‚ùå FALTA:**
- Endpoint de cancelaci√≥n masiva
- Filtros avanzados (por estado, fecha, staff)
- Marcar como completada
- Gestionar no-shows

---

##### ‚úÖ StaffAvailabilityViewSet
**Endpoint:** `/api/v1/staff-availability/`
**Permisos:** (revisar archivo)
**Funcionalidad:** CRUD completo de horarios de staff

---

##### ‚ùå MODELOS SIN API ADMIN

1. **Service** - Solo Django Admin
2. **ServiceCategory** - Solo Django Admin
3. **Package** - Solo Django Admin
4. **WaitlistEntry** - Solo Django Admin
5. **LoyaltyRewardLog** - Solo Django Admin

---

### üë§ PROFILES (Perfiles Cl√≠nicos)

#### Modelos Principales
1. **ClinicalProfile** - Perfil cl√≠nico principal
2. **LocalizedPain** - Dolores localizados
3. **DoshaQuestion** - Preguntas de dosha
4. **DoshaOption** - Opciones de respuesta
5. **ClientDoshaAnswer** - Respuestas de clientes
6. **ConsentTemplate** - Plantillas de consentimiento
7. **ConsentDocument** - Consentimientos firmados
8. **KioskSession** - Sesiones de modo kiosco

#### APIs Disponibles para ADMIN

##### ‚ö†Ô∏è ClinicalProfileViewSet (CRUD Completo - HIPAA Risk)
**Endpoint:** `/api/v1/users/`
**Permisos:** `IsVerifiedUserOrKioskSession, ClinicalProfileAccessPermission`
**Acciones disponibles:**
- `list()` - Admin/Staff ven TODOS los perfiles ‚ö†Ô∏è
- `retrieve()` - Ver perfil completo (auditado)
- `update()` - Modificar perfil (auditado)
- `me()` - Ver/editar propio perfil

**üî¥ PROBLEMA CR√çTICO:**
- Staff tiene acceso sin restricciones a informaci√≥n m√©dica sensible
- No hay control de "need-to-know"
- Auditor√≠a existe pero no previene acceso

---

##### ‚úÖ DoshaQuestionViewSet (CRUD Completo)
**Endpoint:** `/api/v1/dosha-questions-admin/`
**Permisos:** `IsAdminUser`
**Funcionalidad:** Gesti√≥n completa de cuestionarios dosha

---

##### ‚úÖ ConsentTemplateViewSet (CRUD Completo)
**Endpoint:** `/api/v1/consent-templates/`
**Permisos:** `IsAdminUser`
**Funcionalidad:** Gesti√≥n de plantillas de consentimiento

---

##### ‚ùå MODELOS SIN API ADMIN

1. **LocalizedPain** - Solo editable dentro del perfil
2. **ConsentDocument** - Solo lectura/firma, no gesti√≥n admin
3. **KioskSession** - Solo creaci√≥n/verificaci√≥n, no gesti√≥n

---

### üí∞ FINANCES

#### Modelos Principales
1. **Payment** - Pagos
2. **PaymentCreditUsage** - Uso de cr√©ditos
3. **ClientCredit** - Cr√©ditos/saldo a favor
4. **FinancialAdjustment** - Ajustes financieros
5. **SubscriptionLog** - Log de suscripciones
6. **WebhookEvent** - Eventos de webhooks
7. **CommissionLedger** - Libro de comisiones

#### APIs Disponibles para ADMIN

##### ‚úÖ CommissionLedgerListView (SOLO LECTURA)
**Endpoint:** `/api/v1/finances/commissions/`
**Permisos:** `IsAuthenticated, IsStaffOrAdmin`
**Funcionalidad:** Ver comisiones del desarrollador
**Filtros:** status, start_date, end_date

---

##### ‚ùå MODELOS SIN API ADMIN

1. **Payment** - Solo Django Admin
2. **ClientCredit** - Solo Django Admin
3. **FinancialAdjustment** - Solo Django Admin (pero hay endpoint en spa/urls.py)
4. **SubscriptionLog** - Solo Django Admin
5. **WebhookEvent** - Solo Django Admin

**‚ö†Ô∏è CR√çTICO:** No hay API para gestionar pagos manualmente, reembolsos, o ajustes de cr√©dito.

---

### üìä ANALYTICS

#### APIs Disponibles para ADMIN

##### ‚úÖ DashboardViewSet
**Endpoint:** `/api/v1/analytics/dashboard/`
**Permisos:** `CanViewAnalytics`
**Funcionalidad:** Dashboards con m√©tricas cacheadas

---

##### ‚úÖ OperationalInsightsView
**Endpoint:** `/api/v1/analytics/ops/`
**Permisos:** `CanViewOperationalMetrics`
**Funcionalidad:** M√©tricas operacionales

---

##### ‚úÖ BusinessIntelligenceView
**Endpoint:** `/api/v1/analytics/bi/`
**Permisos:** `CanViewFinancialMetrics`
**Funcionalidad:** Inteligencia de negocio

---

##### ‚úÖ KpiView
**Endpoint:** `/api/v1/analytics/kpis/`
**Funcionalidad:** KPIs del negocio

---

##### ‚úÖ AnalyticsExportView
**Endpoint:** `/api/v1/analytics/kpis/export/`
**Funcionalidad:** Exportaci√≥n de datos (Excel)

---

### üë• USERS

#### Modelos Principales
1. **CustomUser** - Usuarios
2. **UserSession** - Sesiones de usuario
3. **BlockedPhoneNumber** - N√∫meros bloqueados
4. **BlockedDevice** - Dispositivos bloqueados
5. **CancellationStreak** - Rachas de cancelaci√≥n

#### APIs Disponibles para ADMIN

##### ‚úÖ FlagNonGrataView
**Endpoint:** `/api/v1/auth/admin/flag-non-grata/<phone_number>/`
**Permisos:** `IsAdminUser`
**Funcionalidad:** Marcar usuarios como persona non grata

---

##### ‚úÖ StaffListView
**Endpoint:** `/api/v1/auth/staff/`
**Permisos:** `IsStaffOrAdmin`
**Funcionalidad:** Listar staff members

---

##### ‚úÖ UserExportView
**Endpoint:** `/api/v1/auth/admin/export/`
**Permisos:** `IsAdminUser`
**Funcionalidad:** Exportar usuarios (JSON/CSV)

---

##### ‚úÖ BlockIPView
**Endpoint:** `/api/v1/auth/admin/block-ip/`
**Permisos:** `IsAdminUser`
**Funcionalidad:** Bloquear IPs temporalmente

---

##### ‚ùå MODELOS SIN API ADMIN

1. **CustomUser** - No hay CRUD admin (solo Django Admin)
2. **UserSession** - Solo ver/eliminar propias sesiones
3. **BlockedPhoneNumber** - Solo Django Admin
4. **BlockedDevice** - Solo Django Admin
5. **CancellationStreak** - Solo Django Admin

**‚ö†Ô∏è FALTA:** API para gestionar usuarios (crear, editar, cambiar roles, etc.)

---

### ü§ñ BOT

#### APIs Disponibles para ADMIN

##### ‚úÖ HumanHandoffRequestViewSet
**Endpoint:** `/api/v1/bot/handoffs/`
**Funcionalidad:** Gesti√≥n de solicitudes de asistencia humana

---

##### ‚úÖ BotAnalyticsView
**Endpoint:** `/api/v1/bot/analytics/`
**Funcionalidad:** Analytics del bot

---

##### ‚úÖ SuspiciousUsersView
**Endpoint:** `/api/v1/bot/suspicious-users/`
**Funcionalidad:** Ver usuarios sospechosos

---

### üîî NOTIFICATIONS

#### Modelos Principales
1. **NotificationPreference** - Preferencias de notificaci√≥n
2. **NotificationLog** - Log de notificaciones enviadas

#### APIs Disponibles

##### ‚úÖ NotificationPreferenceView
**Endpoint:** `/api/v1/notifications/preferences/me/`
**Permisos:** `IsAuthenticated`
**Funcionalidad:** Solo ver/editar propias preferencias

**‚ùå NO HAY:** API admin para ver/gestionar preferencias de todos los usuarios

---

## üéØ RESUMEN DE CAPACIDADES ADMIN

### ‚úÖ LO QUE EL ADMIN PUEDE HACER DESDE API/Frontend

#### Gesti√≥n de Citas
- ‚úÖ Ver todas las citas
- ‚úÖ Crear citas para clientes
- ‚úÖ Reagendar citas
- ‚úÖ Agregar propinas
- ‚ö†Ô∏è Ver sugerencias de horarios

#### Gesti√≥n de √ìrdenes
- ‚úÖ Ver todas las √≥rdenes de todos los usuarios
- ‚úÖ Procesar devoluciones
- ‚ùå Crear √≥rdenes manualmente
- ‚ùå Editar √≥rdenes
- ‚ùå Cambiar estado de env√≠o

#### Gesti√≥n de Productos
- ‚úÖ Ver cat√°logo (p√∫blico)
- ‚ùå Crear productos (solo Django Admin)
- ‚ùå Editar productos (solo Django Admin)
- ‚ùå Gestionar inventario (solo Django Admin)

#### Gesti√≥n de Rese√±as
- ‚úÖ Ver todas las rese√±as
- ‚úÖ Responder a rese√±as
- ‚úÖ Aprobar/rechazar rese√±as

#### Gesti√≥n de Perfiles Cl√≠nicos
- ‚ö†Ô∏è Ver TODOS los perfiles m√©dicos (HIPAA risk)
- ‚ö†Ô∏è Editar cualquier perfil m√©dico (auditado)
- ‚úÖ Gestionar preguntas de dosha
- ‚úÖ Gestionar plantillas de consentimiento

#### Gesti√≥n de Usuarios
- ‚úÖ Marcar como persona non grata
- ‚úÖ Exportar usuarios (CSV/JSON)
- ‚úÖ Bloquear IPs
- ‚úÖ Ver lista de staff
- ‚ùå Crear usuarios (solo Django Admin)
- ‚ùå Editar usuarios (solo Django Admin)
- ‚ùå Cambiar roles (solo Django Admin)

#### Analytics
- ‚úÖ Ver dashboards
- ‚úÖ Ver KPIs
- ‚úÖ Exportar datos
- ‚úÖ M√©tricas operacionales
- ‚úÖ Business intelligence

#### Finanzas
- ‚úÖ Ver comisiones del desarrollador
- ‚ùå Gestionar pagos manualmente
- ‚ùå Procesar reembolsos
- ‚ùå Ajustar cr√©ditos de clientes

---

### ‚ùå LO QUE EL ADMIN **NO** PUEDE HACER (Solo Django Admin)

#### Marketplace
- ‚ùå Crear/editar productos
- ‚ùå Gestionar variantes y SKUs
- ‚ùå Subir im√°genes de productos
- ‚ùå Ajustar inventario
- ‚ùå Ver movimientos de inventario
- ‚ùå Gestionar carritos abandonados

#### Spa
- ‚ùå Crear/editar servicios
- ‚ùå Crear/editar categor√≠as
- ‚ùå Gestionar paquetes
- ‚ùå Ver lista de espera
- ‚ùå Gestionar logs de loyalty

#### Usuarios
- ‚ùå Crear usuarios nuevos
- ‚ùå Editar informaci√≥n de usuarios
- ‚ùå Cambiar roles
- ‚ùå Resetear passwords
- ‚ùå Gestionar sesiones de otros usuarios
- ‚ùå Ver/gestionar dispositivos bloqueados

#### Perfiles
- ‚ùå Gestionar dolores localizados individualmente
- ‚ùå Ver/gestionar consentimientos firmados
- ‚ùå Gestionar sesiones de kiosco

#### Finanzas
- ‚ùå Crear pagos manuales
- ‚ùå Procesar reembolsos
- ‚ùå Ajustar saldo a favor
- ‚ùå Ver/editar ajustes financieros
- ‚ùå Gestionar logs de suscripci√≥n
- ‚ùå Ver webhooks de Wompi

---

## üö® ACCESOS PELIGROSAMENTE ABIERTOS

### üî¥ CR√çTICO

1. **ProductViewSet con AllowAny**
   - Cualquiera puede ver stock, precios VIP, SKUs
   - Expone informaci√≥n competitiva de negocio

2. **Staff con acceso total a √≥rdenes**
   - Direcciones de todos los clientes
   - Historial de compras completo
   - Datos de pago

3. **Staff con acceso total a perfiles m√©dicos**
   - VIOLACI√ìN HIPAA/GDPR
   - Sin control de "need-to-know"
   - Riesgo legal extremo

### ‚ö†Ô∏è ALTO RIESGO

4. **No hay rate limiting efectivo en exports**
   - Posible exfiltraci√≥n masiva de datos
   - DoS via consultas pesadas

5. **Falta validaci√≥n de rangos en analytics**
   - Queries pueden consumir recursos excesivos

---

## üìù RECOMENDACIONES PRIORITARIAS

### üî¥ URGENTE (Implementar YA)

1. **Restringir ProductViewSet**
   ```python
   # Cambiar de AllowAny a IsAuthenticatedOrReadOnly
   # Ocultar stock y precios VIP para usuarios an√≥nimos
   ```

2. **Limitar acceso de Staff a √≥rdenes**
   ```python
   # Staff solo debe ver √≥rdenes que necesite procesar
   # Implementar filtro por estado o asignaci√≥n
   ```

3. **Restringir acceso a perfiles m√©dicos**
   ```python
   # Implementar "need-to-know" basis
   # Staff solo ve perfiles de citas asignadas
   # Requiere justificaci√≥n para otros accesos
   ```

### ‚ö†Ô∏è ALTA PRIORIDAD (Esta semana)

4. **Implementar APIs Admin faltantes:**
   - CRUD de productos y variantes
   - Gesti√≥n de inventario
   - CRUD de usuarios
   - Gesti√≥n de pagos y reembolsos

5. **Agregar rate limiting estricto:**
   - L√≠mites de exportaci√≥n
   - L√≠mites de consultas analytics
   - Throttling por rol

6. **Agregar filtros y b√∫squeda:**
   - Filtros avanzados en √≥rdenes
   - B√∫squeda de usuarios
   - Filtros de citas por estado

### üìä MEDIA PRIORIDAD (Este mes)

7. **Completar CRUDs parciales:**
   - Acciones masivas en rese√±as
   - Gesti√≥n de lista de espera
   - Gesti√≥n de paquetes desde API

8. **Mejorar auditor√≠a:**
   - Alertas en tiempo real para accesos sensibles
   - Dashboard de auditor√≠a para compliance

9. **Implementar permisos granulares:**
   - Separar permisos de STAFF y ADMIN
   - Crear roles intermedios (ej: Manager, Therapist)

---

## üìä TABLA DE COMPLETITUD POR M√ìDULO

| M√≥dulo | CRUD Completo | CRUD Parcial | Solo Django Admin | Sin API | Nivel de Riesgo |
|--------|---------------|--------------|-------------------|---------|-----------------|
| **Marketplace** | Reviews | Orders, Products (read) | Products, Variants, Inventory | Cart (admin view) | üî¥ ALTO |
| **Spa** | Appointments, StaffAvailability | - | Services, Categories, Packages | Waitlist, Loyalty | üü° MEDIO |
| **Profiles** | ClinicalProfile, Dosha, Consent | - | - | LocalizedPain, KioskSession | üî¥ CR√çTICO |
| **Users** | - | Export, Flag, BlockIP | CustomUser, Sessions | BlockedNumbers, Devices | üü° MEDIO |
| **Finances** | - | Commissions (read) | Payments, Credits, Webhooks | - | üü† ALTO |
| **Analytics** | Dashboard, KPIs, Export | - | - | - | üü° MEDIO |
| **Bot** | Handoffs | Analytics, Suspicious | - | - | üü¢ BAJO |
| **Notifications** | - | Preferences (own) | - | NotificationLog | üü¢ BAJO |

---

## üéØ CONCLUSI√ìN

**Estado Actual:** El sistema tiene APIs administrativas INCOMPLETAS y varios RIESGOS DE SEGURIDAD cr√≠ticos.

**Principales Problemas:**
1. üî¥ Acceso p√∫blico a datos sensibles de productos
2. üî¥ Staff con acceso excesivo a informaci√≥n m√©dica (HIPAA violation)
3. üî¥ Staff con acceso total a √≥rdenes de todos los clientes
4. üü° Falta de APIs para gesti√≥n completa de productos e inventario
5. üü° Falta de APIs para gesti√≥n de usuarios y roles
6. üü° Dependencia excesiva del Django Admin

**Impacto en Frontend Admin:**
- ‚ùå No se puede construir un panel admin completo sin Django Admin
- ‚ùå Funcionalidades cr√≠ticas requieren acceso directo a Django Admin
- ‚ö†Ô∏è Riesgos de compliance (HIPAA/GDPR) por accesos no controlados

**Prioridad de Acci√≥n:** üî¥ URGENTE - Corregir vulnerabilidades de acceso antes de implementar nuevas features.
